{{ 'component-cart.css' | asset_url | stylesheet_tag }}
{{ 'component-cart-items.css' | asset_url | stylesheet_tag }}
{{ 'component-totals.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'component-discounts.css' | asset_url | stylesheet_tag }}
{{ 'component-loading-overlay.css' | asset_url | stylesheet_tag }}

{% assign shipingThreshold = settings.cart_drawer_progress_threshold | plus: 0 %}
{% assign cart_total = cart.total_price | divided_by: 100.00 %}
{% assign precentage = cart_total | divided_by: shipingThreshold | times: 100 %}
{% assign upTofree = shipingThreshold | minus: cart_total | times: 100 %}


<script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'cart.js' | asset_url }}" defer="defer"></script>
{% assign user_language = request.locale.iso_code %}
<!-- custom-cart-page-css -->

{{ 'main-cart-items.css' | asset_url | stylesheet_tag }}

<!-- custom cart page -->

<!-- product-cart and total-box -->
{% comment %}
  {%- style -%}
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }
  {%- endstyle -%}

  {%- unless settings.cart_type == 'drawer' -%}
    <script src="{{ 'cart.js' | asset_url }}" defer="defer"></script>
  {%- endunless -%}
{% endcomment %}

{% assign total_cart_compare = 0 %}
{% assign total_cart_price = 0 %}
<div class="cartMain-product cart-main-product page-width {% if cart == empty %} is-empty{% else %} section-{{ section.id }}-padding{% endif %}">
  <div class="page-width">
   {% if settings.cart_drawer_progress_bar_show and settings.cart_drawer_progress_threshold != blank %}
	 <div class="drawer-progressbar mobile-progress" id="mobile-progress" data-shiping-threshold="{{ shipingThreshold }}" data-id="{{ section.id }}">
      <div class="drawer-progressbar-text">
        {% if request.locale.iso_code == 'en' %}
        <p>{% if upTofree <= 0 %}Free shipping{% else %}{{ upTofree | money }} up to Free Shipping{% endif %}</p>
        {% else %}
        <p>{% if upTofree <= 0 %}Livraison gratuite{% else %}{{ upTofree | money }} jusqu'Ã  Livraison gratuite{% endif %}</p>
        {% endif %}
      </div>
       <div>
        <div class="progress-container">
          <div class="progress-bar" id="progress-bar" style="width: {{ precentage }}%;"></div>
        </div>
      </div>
    </div>
  {% endif %}
  <div class="title-wrapper-with-link common_h2 heading-cart-product">      
    <h1 class="title title--primary h2">{{ 'sections.cart.title' | t }} <span>({{ cart.item_count }})</span></h1>
    {% comment %}<a href="{{ routes.all_products_collection_url }}" class="underlined-link">{{ 'general.continue_shopping' | t }}</a>{% endcomment %}
  </div>
  <div class="cart-main-product-inner cart-slider-main-slider">
    <cart-items class="{% if cart == empty %}is-empty{% else %}{% endif %}">  
      <div class="cart__warnings">
        <h1 class="cart__empty-text uppercase">{{ 'sections.cart.empty' | t }}</h1>
        <a href="{{ routes.all_products_collection_url }}" class="button">
          {{ 'general.continue_shopping' | t }}
        </a>
  
        {%- if shop.customer_accounts_enabled and customer == null -%}
          <h2 class="cart__login-title uppercase">{{ 'sections.cart.login.title' | t }}</h2>
          <p class="cart__login-paragraph">
            {{ 'sections.cart.login.paragraph_html' | t: link: routes.account_login_url }}
          </p>
        {%- endif -%}
      </div>  
      <form action="{{ routes.cart_url }}" class="cart__contents critical-hidden" method="post" id="cart">
        <div class="cart__items" id="main-cart-items" data-id="{{ section.id }}">
          <div class="js-contents">
            {%- if cart != empty -%}
              <div class="cart-main-product-productcart-items">
                {%- for item in cart.items -%}
                 {%- liquid
                    assign item_quantity = item.quantity
                 -%}
                  <div class="cart-main-product-image-txt cart-item" id="CartItem-{{ item.index | plus: 1 }}" data-key="{{ item.key }}">
                    <div class="cart-product-image">                      
                      {%- if item.image -%}
                        {% comment %} Leave empty space due to a:empty CSS display: none rule {% endcomment %}
                        <a href="{{ item.url }}" class="cart-item__link" aria-hidden="true" tabindex="-1"> </a>
                        <div class="cart-item__image-container gradient global-media-settings image">
                          <img
                            src="{{ item.image | image_url: width: 300 }}"
                            class="cart-item__image"
                            alt="{{ item.image.alt | escape }}"
                            loading="lazy"
                            width="180"
                            height="{{ 180 | divided_by: item.image.aspect_ratio | ceil }}"
                          >
                        </div>
                      {%- endif -%}
                    </div>
                
                    <div class="cart-product-text custom-cart-desktop">
                      <div class="cart-product-text-inner">
                        <div class="card-header">
                          <div>                                  
                              {%- if settings.show_vendor -%}
                                <p class="caption-with-letter-spacing">{{ item.product.vendor }}</p>
                              {%- endif -%}
                              <div class="header-wrap-title">
                                <a href="{{ item.url }}" class="cart-item__name h4 break">{{ item.product.title | escape }}</a>
                              </div>
                              {% if item.product.metafields.LucVincent.product_type != blank %}
                              <div class="header-wrap-para">
                                <p>{{ item.product.metafields.LucVincent.product_type }}</p>
                              </div>
                              {% endif %}
                              {%- if item.product.has_only_default_variant == false
                                or item.properties.size != 0
                                or item.selling_plan_allocation != null
                              -%}
                                <dl>
                                  {%- if item.product.has_only_default_variant == false -%}
                                    {%- for option in item.options_with_values -%}
                                      <div class="product-option">
                                        <dt>{{ option.name }}:</dt>
                                        <dd>{{ option.value }}</dd>
                                      </div>
                                    {%- endfor -%}
                                  {%- endif -%}
        
                                  {%- for property in item.properties -%}
                                    {%- assign property_first_char = property.first | slice: 0 -%}
                                    {%- if property.last != blank and property_first_char != '_' -%}
                                      <div class="product-option">
                                        <dt>{{ property.first }}:</dt>
                                        <dd>
                                          {%- if property.last contains '/uploads/' -%}
                                            <a href="{{ property.last }}" class="link" target="_blank">
                                              {{ property.last | split: '/' | last }}
                                            </a>
                                          {%- else -%}
                                            {{ property.last }}
                                          {%- endif -%}
                                        </dd>
                                      </div>
                                    {%- endif -%}
                                  {%- endfor -%}
                                </dl>
        
                                <p class="product-option hidden">{{ item.selling_plan_allocation.selling_plan.name }}</p>
                              {%- endif -%}
        
                              <ul class="discounts list-unstyled" role="list" aria-label="{{ 'customer.order.discount' | t }}">
                                {%- for discount in item.discounts -%}
                                  <li class="discounts__discount">
                                    {%- render 'icon-discount' -%}
                                    {{ discount.title }}
                                  </li>
                                {%- endfor -%}
                              </ul>
                          </div>
                          <div class="custom-remove-desktop">
                            <cart-remove-button
                              id="Remove-{{ item.index | plus: 1 }}"
                              data-index="{{ item.index | plus: 1 }}"
                            >
                              <a
                                href="{{ item.url_to_remove }}"
                                class="button button--tertiary"
                                aria-label="{{ 'sections.cart.remove_title' | t: title: item.title }}"
                              >
                                
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M6.33333 1H11.6667M1 3.66667H17M15.2222 3.66667L14.5989 13.0171C14.5053 14.42 14.4586 15.1215 14.1556 15.6533C13.8888 16.1216 13.4864 16.498 13.0015 16.7331C12.4506 17 11.7476 17 10.3416 17H7.65836C6.25236 17 5.54936 17 4.99852 16.7331C4.51356 16.498 4.11119 16.1216 3.84443 15.6533C3.54143 15.1215 3.49467 14.42 3.40114 13.0171L2.77778 3.66667M7.22222 7.66667V12.1111M10.7778 7.66667V12.1111" stroke="black" stroke-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                     
                              </a>
                            </cart-remove-button>
                            </div>
                        </div>
                        {% if item.selling_plan_allocation != blank %}
                          {%- liquid
                             assign currentName = item.selling_plan_allocation.selling_plan.name
                             assign currentPlanID = item.selling_plan_allocation.selling_plan.id
                          -%}
                          <div class="dropdown-cart">
                            <div class="dropdown-cart-inner">
                              <div class="dropdown-cart-main" onclick="cartSubDropDown(event, this); return false;">
                                <div class="dropdown-cart-txt-icon">
                                  <div class="dropdown-cart-text" data-selling-plan-id="{{ currentPlanID }}">
                                    <p>{{ currentName }}</p>
                                  </div>
                                  <div class="dropdown-cart-icon">{% render 'icon-chevron-down' %}</div>
                                </div>
                                <div class="dropdown-cart-container">
                                  <ul>
                                    <li disabled>Delivery Frequency:</li>
                                    {% for selling_plan_groups in item.product.selling_plan_groups %}
                                      {% for selling_plan in selling_plan_groups.selling_plans %}
                                        {%- liquid           
                                          assign name = selling_plan_groups.name         
                                          assign amount = 0 
                                          for selling_plan_option in selling_plan.options 
                                           assign name = selling_plan_option.value 
                                          endfor 
                                          for selling_plan_price_adjustment in selling_plan.price_adjustments           
                                           assign amount = selling_plan_price_adjustment.value 
                                          endfor 
                                          assign selling_plan_option = selling_plan.options 
                                          assign selling_plan_price_adjustment = selling_plan.price_adjustments 
                                           
                                          assign name = name | replace:'-',' ' 
                                          if user_language == 'fr' 
                                           assign name = name | replace:'month','mois' | replace:'Month','Mois' 
                                           assign name = name | replace:'year','annÃ©e' | replace:'Year','AnnÃ©e'
                                           assign name = name | replace:'week','semaine' | replace:'Week','Semaine'
                                           assign name = name | replace:'day','jour' | replace:'Day','Jour'           
                                          endif 
                                        -%}                                              
                                        <li data-value="{{ selling_plan.id }}" {% if currentPlanID == selling_plan.id %}selected{% endif %}
                                          data-discount="{{ amount }}">{% if user_language == 'fr' %}Livrer chaque{% else %}Deliver Every{% endif %} {{ name | capitalize }}</li>
                                      {% endfor %}
                                    {% endfor %}
                                    {% if item.product.requires_selling_plan == false %}
                                      <li data-one-time>{% if user_language == 'fr' %}Achat unique{% else %}One-Time Purchase{% endif %}</li>
                                    {% endif %}
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </div>
                        {% else %}
                          {{ item.product.selected_selling_plan_allocation }}
                          {% if item.product.selling_plan_groups.size > 0 %}
                            {%- liquid
                               assign selling_plan_groups = item.product.selling_plan_groups[0]
                            -%}
                            {% if selling_plan_groups.selling_plans[0] != blank %}
                              {% for selling_plan in selling_plan_groups.selling_plans %}
                                {%- liquid           
                                  assign name = selling_plan_groups.name         
                                  assign amount = 0 
                                  for selling_plan_option in selling_plan.options 
                                   assign name = selling_plan_option.value 
                                  endfor 
                                  for selling_plan_price_adjustment in selling_plan.price_adjustments           
                                   assign amount = selling_plan_price_adjustment.value 
                                  endfor                                   
                                -%}
                            <div class="dropdown-cart dropdown-cart-one-time">
                              <div class="dropdown-cart-inner">
                                <div class="dropdown-cart-main" onclick="cartSubDropDown(event, this); return false;" data-change-plan="true" data-value="{{ selling_plan.id }}">
                                  <div class="dropdown-cart-txt-icon">
                                    <div class="dropdown-cart-text" data-selling-plan-id="{{ selling_plan.id }}">
                                      <p>{% if user_language == 'fr' %}S'abonner et Ã©pargner {% else %}Subscribe & Save {% endif %}{{ amount }}%</p>
                                    </div>
                                    <div class="dropdown-cart-icon">{%- render 'icon-plus', type: 1 -%}</div>
                                  </div>
                                </div>
                              </div>
                            </div>
                                {% endfor %}
                            {% endif %}
                          {% endif %}
                        {% endif %}
                      </div>
                      
                      <div class="cart-button-price">
                        <div class="cart-flex-mobile">
                          <div class="cart-button cart-item__quantity">                              
                            <div class="cart-item__quantity-wrapper">
                              <label class="visually-hidden" for="Quantity-{{ item.index | plus: 1 }}">
                                {{ 'products.product.quantity.label' | t }}
                              </label>
                              <quantity-input class="quantity cart-quantity">
                                <button class="cart-svg quantity__button no-js-hidden" name="minus" type="button">
                                  <span class="visually-hidden">
                                    {{- 'products.product.quantity.decrease' | t: product: item.product.title | escape -}}
                                  </span>
                                  {% render 'icon-minus' %}
                                </button>
                                <input
                                  class="quantity__input cart-input"
                                  data-quantity-variant-id="{{ item.variant.id }}"
                                  type="number"
                                  name="updates[]"
                                  value="{{ item.quantity }}"
                                  {% # theme-check-disable %}
                                  data-cart-quantity="{{ cart | item_count_for_variant: item.variant.id }}"
                                  min="{{ item.variant.quantity_rule.min }}"
                                  {% if item.variant.quantity_rule.max != null %}
                                    max="{{ item.variant.quantity_rule.max }}"
                                  {% endif %}
                                  step="{{ item.variant.quantity_rule.increment }}"
                                  {% # theme-check-enable %}
                                  aria-label="{{ 'products.product.quantity.input_label' | t: product: item.product.title | escape }}"
                                  id="Quantity-{{ item.index | plus: 1 }}"
                                  data-index="{{ item.index | plus: 1 }}"
                                >
                                <button class="cart-svg quantity__button no-js-hidden" name="plus" type="button">
                                  <span class="visually-hidden">
                                    {{- 'products.product.quantity.increase' | t: product: item.product.title | escape -}}
                                  </span>
                                  {% render 'icon-plus' %}
                                </button>
                              </quantity-input>
                            </div>
                            <div class="cart-item__error" id="Line-item-error-{{ item.index | plus: 1 }}" role="alert">
                                <small class="cart-item__error-text"></small>
                                <svg
                                  aria-hidden="true"
                                  focusable="false"
                                  class="icon icon-error"
                                  viewBox="0 0 13 13"
                                >
                                  <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"></circle>
                                  <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"></circle>
                                  <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"></path>
                                  <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7"></path>
                                </svg>
                              </div>
                          </div>
                          <div class="custom-remove-mobile">
                            <cart-remove-button
                              id="Remove-{{ item.index | plus: 1 }}"
                              data-index="{{ item.index | plus: 1 }}"
                            >
                              <a
                                href="{{ item.url_to_remove }}"
                                class="button button--tertiary"
                                aria-label="{{ 'sections.cart.remove_title' | t: title: item.title }}"
                              >
                                
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M6.33333 1H11.6667M1 3.66667H17M15.2222 3.66667L14.5989 13.0171C14.5053 14.42 14.4586 15.1215 14.1556 15.6533C13.8888 16.1216 13.4864 16.498 13.0015 16.7331C12.4506 17 11.7476 17 10.3416 17H7.65836C6.25236 17 5.54936 17 4.99852 16.7331C4.51356 16.498 4.11119 16.1216 3.84443 15.6533C3.54143 15.1215 3.49467 14.42 3.40114 13.0171L2.77778 3.66667M7.22222 7.66667V12.1111M10.7778 7.66667V12.1111" stroke="black" stroke-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                     
                              </a>
                            </cart-remove-button>
                            </div>
                        </div>
                        <div class="cart-price-product">
                          <div class="loading-overlay hidden">
                            <div class="loading-overlay__spinner">
                              <svg
                                aria-hidden="true"
                                focusable="false"
                                class="spinner"
                                viewBox="0 0 66 66"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                              </svg>
                            </div>
                          </div>
                          {% comment %}-------------
                          {%- if item.original_price != item.final_price -%}
                            <div class="price cart-item__discounted-prices">
                              <span class="visually-hidden">
                                {{ 'products.product.price.regular_price' | t }}
                              </span>
                              <s class="cart-item__old-price product-option price_no_active">
                                {{- item.original_price | money -}}
                              </s>
                              <span class="visually-hidden">
                                {{ 'products.product.price.sale_price' | t }}
                              </span>
                              <strong class="cart-item__final-price product-option price_root">
                                {{ item.final_price | money }}
                              </strong>
                            </div>
                          {%- else -%}
                            <div class="product-option price_root">
                              {{ item.original_price | money }}
                            </div>
                          {%- endif -%}-------------{% endcomment %}
                          {% if item.selling_plan_allocation != blank %}
                            {%- liquid
                               assign temp_com = item.selling_plan_allocation.compare_at_price | times: item_quantity
                               assign temp_price = item.selling_plan_allocation.price | times: item_quantity
                               assign total_cart_compare = total_cart_compare | plus: temp_com
                               assign total_cart_price = total_cart_price | plus: temp_price
                            -%}
                            <dl class="price cart-item__discounted-prices">
                              <dd>
                                <s class="cart-item__old-price price price--end price_no_active">
                                  {{- item.selling_plan_allocation.compare_at_price | times: item_quantity | money -}}
                                </s>
                              </dd>
                              <dd class="price price--end price_root">
                                {{ item.selling_plan_allocation.price | times: item_quantity | money }}
                              </dd>
                            </dl>
                          {%- elsif item.original_line_price != item.final_line_price -%}
                            {% assign total_cart_compare = total_cart_compare | plus: item.original_line_price %}
                            {% assign total_cart_price = total_cart_price | plus: item.final_line_price %}
                            <dl class="price cart-item__discounted-prices">
                              <dt class="visually-hidden">
                                {{ 'products.product.price.regular_price' | t }}
                              </dt>
                              <dd>
                                <s class="cart-item__old-price price price--end price_no_active">
                                  {{ item.original_line_price | money }}
                                </s>
                              </dd>
                              <dt class="visually-hidden">
                                {{ 'products.product.price.sale_price' | t }}
                              </dt>
                              <dd class="price price--end price_root">
                                {{ item.final_line_price | money }}
                              </dd>
                            </dl>
                          {%- else -%}
                            {% assign total_cart_compare = total_cart_compare | plus: item.original_line_price %}
                            {% assign total_cart_price = total_cart_price | plus: item.original_line_price %}
                            <span class="price price--end price_root">
                              {{ item.original_line_price | money }}
                            </span>
                          {%- endif -%}
  
                          {%- if item.variant.available and item.unit_price_measurement -%}
                            <div class="unit-price caption">
                              <span class="visually-hidden">{{ 'products.product.price.unit_price' | t }}</span>
                              {{ item.variant.unit_price | money }}
                              <span aria-hidden="true">/</span>
                              <span class="visually-hidden"
                                >&nbsp;{{ 'accessibility.unit_price_separator' | t }}&nbsp;</span
                              >
                              {%- if item.variant.unit_price_measurement.reference_value != 1 -%}
                                {{- item.variant.unit_price_measurement.reference_value -}}
                              {%- endif -%}
                              {{ item.variant.unit_price_measurement.reference_unit }}
                            </div>
                          {%- endif -%}
                        </div>
                      </div>
                    </div>
                </div>
                {% endfor %}
              </div>
            {%- endif -%}
          </div>
        </div>
  
        <p class="visually-hidden" id="cart-live-region-text" aria-live="polite" role="status"></p>
        <p class="visually-hidden" id="shopping-cart-line-item-status" aria-live="polite" aria-hidden="true" role="status">
          {{ 'accessibility.loading' | t }}
        </p>
      </form>
      {% if settings.cart_drawer_routine_show %}
        {% render 'cart-drawer-routine-pro' %}
      {% endif %} 
    </cart-items>
    <div class="cart-checkout-box{% if cart == empty %} is-empty{% endif %}" id="main-cart-footer" data-id="{{ section.id }}">
      <div>
      <div class="cart__footer">
        {%- if settings.show_cart_note -%}
          <cart-note class="cart__note field">
            <label for="Cart-note">{{ 'sections.cart.note' | t }}</label>
            <textarea
              class="text-area field__input"
              name="note"
              form="cart"
              id="Cart-note"
              placeholder="{{ 'sections.cart.note' | t }}"
            >{{ cart.note }}</textarea>
          </cart-note>
        {%- endif -%}
  
        <div class="cart__blocks cart-checkout-main">
            {% if settings.cart_drawer_progress_bar_show and settings.cart_drawer_progress_threshold != blank %}
            <!-- progress-bar -->
            
            <div class="drawer-progressbar desktop-cart-progress" data-shiping-threshold="{{ shipingThreshold }}">
              <div class="drawer-progressbar-text">
                {% if request.locale.iso_code == 'en' %}
                <p>{% if upTofree <= 0 %}Free shipping{% else %}{{ upTofree | money }} up to Free Shipping{% endif %}</p>
                {% else %}
                <p>{% if upTofree <= 0 %}Livraison gratuite{% else %}{{ upTofree | money }} jusqu'Ã  Livraison gratuite{% endif %}</p>
                {% endif %}
              </div>
               <div>
                <div class="progress-container">
                  <div class="progress-bar" id="progress-bar" style="width: {{ precentage }}%;"></div>
                </div>
              </div>
            </div>
            {% endif %}

          
          {% for block in section.blocks %}
            {%- case block.type -%}
              {%- when '@app' -%}
                {% render block %}
              {%- when 'subtotal' -%}
                <div class="cart-page-div">
            
                <div class="js-contents-footer" {{ block.shopify_attributes }}>
                  {%- liquid
                    assign total_cart_compare = total_cart_compare
                    assign total_cart_price = total_cart_price
                     assign hasSaving = false
                     if total_cart_compare > total_cart_price and total_cart_compare != total_cart_price 
                       assign hasSaving = true
                     endif
          
                    assign discont_amount = 0
                    if cart.cart_level_discount_applications.size > 0           
                    assign hasSaving = true 
                      for discount in cart.cart_level_discount_applications 
                       assign discont_amount = discont_amount | plus : discount.total_allocated_amount
                      endfor
                    endif 
                  -%}
                  {% assign total_cart_compare = total_cart_compare %}
                  {% assign total_cart_price = total_cart_price %}
                  {% if hasSaving %}
                  <div class="cart-total-saving" {{ total_cart_compare }} {{ total_cart_price }}>
                    <div class="cart-total">
                      <p class="cart-total-text">{% if user_language == 'fr' %}Panier Total{% else %}Cart Total{% endif %}</p>
                      <p class="cart-total-price">{{ total_cart_compare | money }}</p>
                    </div>
                    <div class="cart-saving">
                      <p class="cart-total-text">{% if user_language == 'fr' %}Votre Ã©pargne{% else %}Your Savings{% endif %}</p>
                      <p class="cart-total-price">â {{ total_cart_compare | minus: total_cart_price | plus: discont_amount | abs | money }}</p>
                    </div>
                  </div>
                  {% endif %}
                  <div class="totals cart-subtotal-price">
                    <div class="totals__subtotal card-subtotal-txt common_h2">
                      <div class="sub-totals">{{ 'sections.cart.subtotal' | t }}</div>
                    </div>
                    <div class="totals__subtotal-value cart-subtotal-main-price common_h2">
                      <div class="h2">{{ cart.total_price | money }}</div>
                    </div>
                  </div>
  
                  <div>
                    {%- if cart.cart_level_discount_applications.size > 0 -%}
                      <ul class="discounts list-unstyled" role="list" aria-label="{{ 'customer.order.discount' | t }}">
                        {%- for discount in cart.cart_level_discount_applications -%}
                          <li class="discounts__discount discounts__discount--position">
                            {%- render 'icon-discount' -%}
                            {{ discount.title }}
                            (-{{ discount.total_allocated_amount | money }})
                          </li>
                        {%- endfor -%}
                      </ul>
                    {%- endif -%}
                  </div>
  
                  <small class="card-subtotal-txt tax-note">
                    <p>
                    {%- if cart.taxes_included and shop.shipping_policy.body != blank -%}
                      {{ 'sections.cart.taxes_included_and_shipping_policy_html' | t: link: shop.shipping_policy.url }}
                    {%- elsif cart.taxes_included -%}
                      {{ 'sections.cart.taxes_included_but_shipping_at_checkout' | t }}
                    {%- elsif shop.shipping_policy.body != blank -%}
                      {{ 'sections.cart.taxes_and_shipping_policy_at_checkout_html' | t: link: shop.shipping_policy.url }}
                    {%- else -%}
                      {{ 'sections.cart.taxes_and_shipping_at_checkout' | t }}
                    {%- endif -%}
                    </p>
                  </small>
                </div>
              {%- else -%}
                <div class="limoniapps-discountninja-cartdiscountfield-placeholder"></div>
                <div class="cart__ctas btn-checkout" {{ block.shopify_attributes }}>
                  <noscript>
                    <button type="submit" class="cart__update-button button button--secondary" form="cart">
                      {{ 'sections.cart.update' | t }}
                    </button>
                  </noscript>
  
                  <button
                    type="submit"
                    id="checkout"
                    class="btn-checkout-inner cart__checkout-button button cart__checkout"
                    name="checkout"
                    {% if cart == empty %}
                      disabled
                    {% endif %}
                    form="cart"
                  >
                    {{ 'sections.cart.checkout' | t }}
                  </button>
                </div>
                {% comment %}
                {%- if additional_checkout_buttons -%}
                  <div class="cart__dynamic-checkout-buttons additional-checkout-buttons">
                    {{ content_for_additional_checkout_buttons }}
                  </div>
                {%- endif -%}{% endcomment %}
                {%- if settings.cart_drawer__showIcons -%}
                  {%- for i in (1..3) -%}
                    {%- capture icon %}cart_drawer__icon_{{ i }}{% endcapture -%}
                    {%- capture text %}cart_drawer__text_{{ i }}{% endcapture -%}
                    {%- liquid
                       assign icon = settings[icon]
                       assign text = settings[text]
                    -%}
                    {% capture btnIcon %}{{ btnIcon }}
                   
                      {%- if icon != blank or text != blank -%}
                        <li class="cart__sales-point">
                          <span class="icon-and-text">{%- if icon != blank -%}{{ icon }}{%- endif -%}</span>
                          <span>{{ text }}</span>
                        </li>
                      {%- endif -%}
                   
                    {% endcapture %}
                  {%- endfor -%}
                  {% assign btnIcon = btnIcon | strip_newlines | strip %}
                  {% if btnIcon != blank %}
                    <div class="cart__block--sales-point">
                      <ul class="cart__sales-points list-unstyled">{{ btnIcon }}</ul>
                    </div>
                  {% endif %}
                {% endif %}
            {%- endcase -%}
          {% endfor %}
  
          <div id="cart-errors"></div>
        </div>
        </div>
      </div>
    </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", (event) => {
  
    let swiperElement = document.querySelector('.cartMain-product .completeRoutine--swiper');
    if(swiperElement){
      this.routineSliderSwiper = new Swiper( swiperElement, {
        speed: 500,
        slidesPerView: 1,
        slidesPerGroup: 1,
        spaceBetween: 0,      
        autoHeight: true,
        navigation: {
          nextEl: ".cart-drawer-swiper-next",
          prevEl: ".cart-drawer-swiper-prev",
        },
        breakpoints: {
          0: {
            autoHeight: true
          },
          750: {
            autoHeight: false
          }
        },
      });
    }
    {% comment %}
    var swiper = new Swiper(".cart-slider", {
        slidesPerView: 1,
        spaceBetween: 10,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        breakpoints: {
            640: {
                slidesPerView: 2,
                spaceBetween: 20,
            },
            768: {
                slidesPerView: 4,
                spaceBetween: 30,
            },
            1024: {
                slidesPerView: 4,
                spaceBetween: 40,
            },
        },
    });    
    {% endcomment %}
  });
</script>

{% schema %}
{
  "name": "t:sections.main-cart-items.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "subtotal",
      "name": "t:sections.main-cart-footer.blocks.subtotal.name",
      "limit": 1
    },
    {
      "type": "buttons",
      "name": "t:sections.main-cart-footer.blocks.buttons.name",
      "limit": 1
    },
    {
      "type": "@app"
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "subtotal"
      },
      {
        "type": "buttons"
      }
    ]
  }
}
{% endschema %}
